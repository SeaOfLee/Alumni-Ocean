<%= render 'layouts/sidenav' %>

  <div class="main_container">

    <div class='row clearfix'>
      <div class='column full'>
        <h1>Post a New Job</h1>
      </div>
    </div>

      <%= form_for @job do |f| %>
        <div class='row clearfix'>
          <div class='column half'><%= f.text_field :job_title, :placeholder => "Enter the job title..." %></div>
          <div class='column half'><%= f.text_field :company, :placeholder => "Enter the company name..." %></div>
        </div>

        <div class='row clearfix'>
          <div class='column full'><%= f.text_field :location, id: 'location', :placeholder => "Enter the job location..." %></div>
        </div>

        <div class='row clearfix'>
          <div class='column half'><%= select(:job, :job_type, [['Full-time', "Full-time"], ['Part-time'], ['Remote'], ['Contract']]) %></div>
          <div class='column half'><%= f.text_field :contact, :placeholder => "Enter the contact email.." %></div>
        </div>

        <div class='row clearfix'>
          <div class='column full'><%= f.text_area :description, :placeholder => "Give more details about the job here..." %></div>
        </div>

        <div class='row clearfix'>
          <div class='column full'><%= f.submit 'Post the job', class: 'button', id: 'map_button'  %></div>
        </div>

        <%= f.hidden_field :lat %>
        <%= f.hidden_field :long %>

        <% end %>

        <script type="text/javascript">

          // Autocomplete variables
          var input = document.getElementById('location');
          // var searchform = document.getElementById('form1');
          var place;
          var autocomplete = new google.maps.places.Autocomplete(input);

          // Add listener to detect autocomplete selection
          google.maps.event.addListener(autocomplete, 'place_changed', function () {
            place = autocomplete.getPlace();
            var newlatlong = new google.maps.LatLng(place.geometry.location.lat(),place.geometry.location.lng());
            var newLat = place.geometry.location.lat()
            var newLong = place.geometry.location.lng()
            console.log(newlatlong);
            console.log(newLat);
            console.log(newLong);
            $("#job_lat").val(newLat);
            $("#job_long").val(newLong);
          });

          // Reset the input box on click
          input.addEventListener('click', function(){
            input.value = "";
          });

        </script>

</div>
